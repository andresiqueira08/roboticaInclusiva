<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Login ‚Äì Mapa Colaborativo</title>

    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/mobile.css">
</head>

<body>
    <div class="screen login-screen active">
        <div class="page">

            <!-- TOPO -->
            <div class="top-bar">
                <div class="title">Mapa Colaborativo</div>
            </div>

            <!-- CONTAINER LOGIN -->
            <div class="login-container">
                <div class="login-header">
                    <div class="login-icon">üó∫Ô∏è</div>
                    <h2 class="login-title">Bem-vindo</h2>
                    <p class="login-subtitle">Acesse sua conta para continuar</p>
                </div>

                <form class="login-form" id="loginForm">

                    <div class="form-group">
                        <label for="email">Email</label>
                        <input 
                            type="email" 
                            id="email"
                            placeholder="seu@email.com"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input 
                            type="password" 
                            id="password"
                            placeholder="Sua senha"
                            required
                        >
                    </div>

                    <button type="submit" class="login-btn" id="loginBtn">
                        <span>Entrar</span>
                    </button>
                </form>

                <div class="login-footer">
                    <p class="demo-info">
                        <strong>Demo:</strong> Use qualquer email e senha para testar
                    </p>
                </div>
            </div>

            <!-- NOTIFICA√á√ÉO -->
            <div class="notification" id="notification"></div>

        </div>
    </div>

    <!-- SCRIPT CORRIGIDO -->
    <script>
        const loginForm = document.getElementById('loginForm');
        const loginBtn = document.getElementById('loginBtn');
        const notification = document.getElementById('notification');

        function showNotification(msg, type = 'success') {
            notification.textContent = msg;
            notification.style.display = 'block';
            notification.style.background =
                type === 'success' ? 'var(--primary-color)' : 'var(--error-color)';
            setTimeout(() => notification.style.display = 'none', 2500);
        }

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value.toLowerCase().trim();
            const password = document.getElementById('password').value;

            if (!email || !password) {
                showNotification('Preencha todos os campos', 'error');
                return;
            }

            loginBtn.disabled = true;
            loginBtn.innerHTML = "<span>Entrando...</span>";

            setTimeout(() => {
                const type = email.includes("arqueologo") ? "arqueologo" : "publico";

                // SALVA O USU√ÅRIO
                localStorage.setItem("user", JSON.stringify({
                    email,
                    type,
                    name: email.split("@")[0]
                }));

                showNotification("Login realizado!");

                setTimeout(() => {
                    if (type === "arqueologo") {
                        window.location.href = "../GaleriaArqueologos/GaleriaArqueologosScreen.html";
                    } else {
                        window.location.href = "../GaleriaPublico/GaleriaPublicoScreen.html";
                    }
                }, 700);

            }, 800);
        });

        // EVITA REDIRECIONAMENTO AUTOM√ÅTICO ERRADO
        document.addEventListener("DOMContentLoaded", () => {
            // N√ÉO AUTOLOGAR MAIS AQUI!
            // Tela de login SEMPRE deve abrir primeiro.
        });
    </script>

</body>
</html>
